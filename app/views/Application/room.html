#{extends 'main.html' /}
#{set title:'Chatroom' /}

<h2>The chat room</h2>

<br/>
<div id="messages">


</div>
<hr/>
<input id="text" type="text" value=""/><input id="send" type="submit" value="send"/>

<script>
var socket = new WebSocket("@@{Application.Chatroom.join(user)}");
socket.onmessage = function(event) {
	var parts = /^([^:]+):(.*)?$/.exec(event.data)
	$("#messages").append("<li><b>" + parts[1] + "</b>: <span style='padding-left:12pt'>" + parts[2] + "</span>"); 
};

$("#send").click(function() {
	socket.send($("#text").val());
	$("#text").val(""); 
});


</script>

